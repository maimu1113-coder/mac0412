<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no,viewport-fit=cover">
    <title>Mac tok PRO - Ultimate</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <script src="https://cdn.jsdelivr.net/npm/tiktok-live-connect@0.1.4/dist/browser/tiktok-live-connect.min.js"></script>
    <style>
        :root { --primary: #ff0050; --bg: #0b0d10; --card: #16181d; --text: #ffffff; --green: #2ecc71; }
        body { background: var(--bg); color: var(--text); font-family: -apple-system, sans-serif; margin: 0; overflow-x: hidden; }
        
        /* ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ï¼ˆç”»åƒ14æšç›®æº–æ‹ ï¼‰ */
        #login-screen { position: fixed; inset: 0; background: #000; z-index: 2000; display: flex; align-items: center; justify-content: center; }
        .login-box { width: 90%; max-width: 350px; text-align: center; }
        .input-id { width: 100%; padding: 18px; background: #1a1a1a; border: 1px solid #333; border-radius: 12px; color: #fff; font-size: 16px; margin: 20px 0; text-align: center; }
        
        /* ãƒ¡ã‚¤ãƒ³UI */
        #app { display: none; }
        .header { background: var(--card); padding: 15px; border-bottom: 1px solid #222; position: sticky; top: 0; z-index: 100; }
        .user-profile { display: flex; align-items: center; gap: 12px; }
        #avatar { width: 45px; height: 45px; border-radius: 50%; border: 2px solid var(--primary); background: #333; }
        
        /* ã‚¿ãƒ– (ç”»åƒ11æšç›®æº–æ‹ ) */
        .tabs { display: flex; background: var(--card); position: sticky; top: 76px; z-index: 99; border-bottom: 1px solid #222; }
        .tab { flex: 1; text-align: center; padding: 15px; color: #888; font-size: 13px; font-weight: bold; cursor: pointer; }
        .tab.active { color: #fff; border-bottom: 3px solid var(--primary); }

        .page { display: none; padding: 15px; animation: fadeIn 0.3s; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .card { background: var(--card); border-radius: 14px; padding: 18px; margin-bottom: 15px; border: 1px solid #222; }
        .card-title { font-size: 11px; color: #888; text-transform: uppercase; margin-bottom: 15px; letter-spacing: 1px; }

        .btn-connect { width: 100%; padding: 18px; background: var(--primary); border: none; border-radius: 14px; color: #fff; font-weight: bold; font-size: 16px; cursor: pointer; box-shadow: 0 4px 15px rgba(255,0,80,0.3); }
        .btn-connect:disabled { background: #444; box-shadow: none; }

        .row { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #222; }
        input[type="range"] { width: 60%; accent-color: #ff9f0a; }
        .log-area { background: #000; color: var(--green); font-family: 'Courier New', monospace; font-size: 11px; height: 150px; overflow-y: auto; padding: 12px; border-radius: 10px; border: 1px solid #333; line-height: 1.5; }
    </style>
</head>
<body>

    <div id="login-screen">
        <div class="login-box">
            <h1 style="font-size:35px; margin:0;">Mac tok <span style="color:var(--primary)">PRO</span></h1>
            <p style="color:#666; font-size:14px; margin-top:10px;">Security Bypass Engine v2.0</p>
            <input type="text" id="id-input" class="input-id" value="mac.d.onald.no1" placeholder="TikTok ID (@ãªã—)">
            <button class="btn-connect" onclick="doLogin()">ã‚·ã‚¹ãƒ†ãƒ èªè¨¼ / ãƒ­ã‚°ã‚¤ãƒ³</button>
        </div>
    </div>

    <div id="app">
        <div class="header">
            <div class="user-profile">
                <img id="avatar" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=">
                <div style="flex:1;">
                    <div id="u-name" style="font-weight:bold; font-size:17px;">---</div>
                    <div id="u-status" style="font-size:11px; color:#888;">OFFLINE</div>
                </div>
                <div style="background:var(--green); font-size:9px; padding:3px 8px; border-radius:4px; font-weight:bold;">ULTIMATE PLAN</div>
            </div>
        </div>

        <div class="tabs">
            <div class="tab active" id="t-home" onclick="showP('home')">ãƒ›ãƒ¼ãƒ </div>
            <div class="tab" id="t-tts" onclick="showP('tts')">TTSè¨­å®š</div>
            <div class="tab" id="t-alert" onclick="showP('alert')">ã‚¢ãƒ©ãƒ¼ãƒˆ</div>
        </div>

        <div id="p-home" class="page active">
            <div class="card">
                <div class="card-title">æœ€é€ŸåŒæœŸã‚¨ãƒ³ã‚¸ãƒ³</div>
                <button class="btn-connect" id="startBtn" onclick="ultimateConnect()">é…ä¿¡ã«æœ€é€Ÿã§æ¥ç¶šã™ã‚‹</button>
                <p style="font-size:11px; color:#888; text-align:center; margin-top:10px;">â€»é…ä¿¡é–‹å§‹å¾Œã«æŠ¼ã—ã¦ãã ã•ã„</p>
            </div>
            <div class="card">
                <div class="card-title">ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ»ãƒã‚¤ãƒ‘ã‚¹ãƒ­ã‚°</div>
                <div id="log" class="log-area">ã‚·ã‚¹ãƒ†ãƒ å¾…æ©Ÿä¸­...</div>
            </div>
        </div>

        <div id="p-tts" class="page">
            <div class="card">
                <div class="card-title">éŸ³å£°ã‚¨ãƒ³ã‚¸ãƒ³è¨­å®š (ç”»åƒ2, 4æšç›®æº–æ‹ )</div>
                <div class="row"><span>èª­ã¿ä¸Šã’é€Ÿåº¦</span><input type="range" id="rate" min="10" max="100" value="50"></div>
                <div class="row"><span>å£°ã®é«˜ã•</span><input type="range" id="pitch" min="10" max="100" value="50"></div>
            </div>
            <div class="card">
                <div class="card-title">ã‚¹ãƒ‘ãƒ ãƒ•ã‚£ãƒ«ã‚¿ (ç”»åƒ16æšç›®æº–æ‹ )</div>
                <div class="row"><span>ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³(ç§’)</span><input type="number" id="cd" value="3" style="width:50px; background:#000; color:#fff; border:1px solid #333;"></div>
                <div class="row"><span>æœ€ä½ã‚³ã‚¤ãƒ³æ•°</span><input type="number" id="minC" value="1" style="width:50px; background:#000; color:#fff; border:1px solid #333;"></div>
            </div>
        </div>

        <div id="p-alert" class="page">
            <div class="card">
                <div class="card-title">ã‚¤ãƒ™ãƒ³ãƒˆæ¤œçŸ¥ (ç”»åƒ8, 10, 12æšç›®æº–æ‹ )</div>
                <div class="row"><span>ã‚®ãƒ•ãƒˆã‚’èª­ã¿ä¸Šã’ã‚‹</span><input type="checkbox" id="gOn" checked></div>
                <div class="row"><span>ãƒ•ã‚©ãƒ­ãƒ¼ã‚’èª­ã¿ä¸Šã’ã‚‹</span><input type="checkbox" id="fOn" checked></div>
                <div class="row"><span>ã‚·ã‚§ã‚¢ã‚’èª­ã¿ä¸Šã’ã‚‹</span><input type="checkbox" id="sOn" checked></div>
            </div>
        </div>
    </div>

<script>
    let tid = "";
    let userCD = {};
    let con = null;

    function showP(n) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.getElementById('p-' + n).classList.add('active');
        document.getElementById('t-' + n).classList.add('active');
    }

    function doLogin() {
        tid = document.getElementById('id-input').value.trim().replace('@','');
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('app').style.display = 'block';
        document.getElementById('u-name').innerText = "@" + tid;
    }

    function speak(text) {
        const u = new SpeechSynthesisUtterance(text);
        u.lang = 'ja-JP';
        u.rate = document.getElementById('rate').value / 50;
        u.pitch = document.getElementById('pitch').value / 50;
        window.speechSynthesis.speak(u);
    }

    async function ultimateConnect() {
        const btn = document.getElementById('startBtn');
        const log = document.getElementById('log');
        const status = document.getElementById('u-status');
        
        btn.innerText = "ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å›é¿ä¸­...";
        btn.disabled = true;
        log.prepend(`ğŸš€ æ¥ç¶šã‚¨ãƒ³ã‚¸ãƒ³èµ·å‹•: @${tid}\n`);

        const tryConnect = async (attempt = 1) => {
            try {
                // æ¥ç¶šã”ã¨ã«ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç ´æ£„ã—ã¦ãƒ¡ãƒ¢ãƒªã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
                if (con) con.disconnect();
                
                con = new TikTokLiveConnector.WebcastPushConnection(tid, {
                    enableExtendedGiftInfo: true,
                    requestPollingIntervalMs: 1000 // åŒæœŸé€Ÿåº¦ã‚’æœ€å¤§åŒ–
                });

                const state = await con.connect();
                
                log.prepend(`âœ… æ¥ç¶šæˆåŠŸï¼å›é¿ã«æˆåŠŸã—ã¾ã—ãŸã€‚\n`);
                btn.innerText = "åŒæœŸæ¸ˆã¿ (LIVE ON)";
                btn.style.background = var(--green);
                status.innerText = "ONLINE";
                status.style.color = var(--green);
                
                if(state.roomInfo && state.roomInfo.owner) {
                    document.getElementById('avatar').src = state.roomInfo.owner.avatar_thumb.url_list[0];
                }
                speak("ãƒãƒƒã‚¯ãƒˆãƒƒã‚¯ã€ãƒã‚¤ãƒ‘ã‚¹å®Œäº†ã€‚ã‚·ã‚¹ãƒ†ãƒ ã‚’é–‹å§‹ã—ã¾ã™ã€‚");

                con.on('chat', d => {
                    const limit = document.getElementById('cd').value * 1000;
                    if(userCD[d.uniqueId] && (Date.now() - userCD[d.uniqueId] < limit)) return;
                    userCD[d.uniqueId] = Date.now();
                    log.prepend(`[CHAT] ${d.nickname}: ${d.comment}\n`);
                    speak(`${d.nickname}ã€${d.comment}`);
                });

                con.on('gift', d => {
                    if(!document.getElementById('gOn').checked || d.diamondCount < document.getElementById('minC').value) return;
                    log.prepend(`[GIFT] ${d.nickname}: ${d.giftName}\n`);
                    speak(`${d.nickname}ã•ã‚“ã€${d.giftName}ã‚ã‚ŠãŒã¨ã†ï¼`);
                });

                con.on('follow', d => {
                    if(!document.getElementById('fOn').checked) return;
                    log.prepend(`[FOLLOW] ${d.nickname}ã•ã‚“ãŒãƒ•ã‚©ãƒ­ãƒ¼ï¼\n`);
                    speak(`${d.nickname}ã•ã‚“ã€ãƒ•ã‚©ãƒ­ãƒ¼ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼`);
                });

            } catch (err) {
                log.prepend(`âš ï¸ å›é¿å¤±æ•—(è©¦è¡Œ:${attempt}) - å†è¨ˆç®—ã—ã¦ãƒªãƒˆãƒ©ã‚¤ã—ã¾ã™...\n`);
                if (attempt < 10) {
                    setTimeout(() => tryConnect(attempt + 1), 2000);
                } else {
                    log.prepend(`âŒ é‡å¤§ãªã‚¨ãƒ©ãƒ¼: é…ä¿¡ãŒé–‹å§‹ã•ã‚Œã¦ã„ãªã„ã‹ã€TikTokã«ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¾ã—ãŸã€‚1åˆ†å¾Œã«å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚\n`);
                    btn.innerText = "å†æ¥ç¶šã‚’è©¦ã¿ã‚‹";
                    btn.disabled = false;
                }
            }
        };

        tryConnect();
    }
</script>
</body>
</html>
