<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<title>Mac Talk PRO</title>
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>

<body style="background:#000;color:#fff;text-align:center;">
  <h1>Mac Talk PRO</h1>

  <input id="targetId" placeholder="TikTok ID" value="macrecords1"
    style="padding:10px;width:80%;font-size:16px;">

  <div id="start"
    style="margin:20px auto;width:200px;height:200px;
    background:#ff0050;border-radius:50%;
    display:flex;align-items:center;justify-content:center;
    font-size:24px;font-weight:bold;cursor:pointer;">
    START
  </div>

  <div id="log"></div>

<script>
const socket = io();
const log = document.getElementById("log");

function speak(text){
  speechSynthesis.cancel();
  const u = new SpeechSynthesisUtterance(text);
  u.lang = "ja-JP";
  speechSynthesis.speak(u);
}

document.getElementById("start").onclick = () => {
  speak("起動します");
  socket.emit("start", document.getElementById("targetId").value);
};

socket.on("chat", data => {
  log.innerHTML += `<p>${data.user}: ${data.text}</p>`;
  speak(`${data.user}さん、${data.text}`);
});
</script>
</body>
</html>
