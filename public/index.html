<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mac Talk PRO</title>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>

<body style="background:#000;color:#fff;text-align:center;font-family:sans-serif;">
  <h1 style="color:#00f2ea;">Mac Talk PRO</h1>

  <input id="targetId" placeholder="TikTok ID"
    style="padding:15px;width:80%;font-size:16px;border-radius:10px;" />

  <div id="start"
    style="margin:20px auto;width:180px;height:180px;
    background:#ff0050;border-radius:50%;
    display:flex;align-items:center;justify-content:center;
    font-size:24px;font-weight:bold;cursor:pointer;">
    START
  </div>

  <div id="log" style="padding:10px;"></div>

<script>
const socket = io();

const log = document.getElementById("log");
const startBtn = document.getElementById("start");

function speak(text) {
  const u = new SpeechSynthesisUtterance(text);
  u.lang = "ja-JP";
  speechSynthesis.cancel();
  speechSynthesis.speak(u);
}

startBtn.onclick = () => {
  const id = document.getElementById("targetId").value.trim();
  if (!id) return alert("TikTok ID ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");

  speak("æ¥ç¶šã—ã¾ã™");
  socket.emit("start", id);
};

socket.on("status", s => {
  log.innerHTML += `<p>ğŸ“¡ ${s}</p>`;
});

socket.on("chat", data => {
  log.innerHTML += `<p>${data.user}ï¼š${data.text}</p>`;
  speak(`${data.user}ã•ã‚“ ${data.text}`);
});

socket.on("gift", data => {
  const t = `ğŸ ${data.user} ${data.giftName} Ã—${data.count}`;
  log.innerHTML += `<p style="color:yellow">${t}</p>`;
  speak(t);
});
</script>
</body>
</html>
